<?php

use app\assets\DependencyGraphAsset;
use app\helpers\Html;

/** @var array $sections */
/** @var string $title */
/** @var string $subTitle */
/** @var bool $hasDependencies */

$this->title = $title;
$this->subTitle = $subTitle;

DependencyGraphAsset::register($this);

?>

    <h1>Yii 3 packages</h1>

<?php foreach ($sections as $section => $packages): ?>
    <h2><?= $section ?></h2>
    <div class="row mb-5">
        <?php foreach ($packages as $package => $infos): ?>
            <div class=" col-md-3 mb-3">
                <div class="package-card card h-100">
                    <div class="card-header">
                        <b><?= Html::a($package, ['site/package', 'package' => $package]) ?></b>
                        <?= Html::a(Html::o('mark-github'), 'https://github.com/yiisoft/' . $package, ['class' => 'float-right']) ?>
                    </div>
                    <div class="card-body h-100 text-center">
                        <a href="/img/dependencies/<?= $infos['id'] ?>-nodev.svg"><img src="/img/dependencies/<?= $infos['id'] ?>-nodev.svg" class="img-fluid" style="max-height: 100px;" alt="<?= $infos['id'] ?> dependencies without dev" /></a>
                    </div>
                    <div class="card-footer">
                        <?= Html::travisBadge($package, $infos['travis']) ?>
                    </div>
                </div>
            </div>

        <?php endforeach ?>
    </div>
<?php endforeach ?>



   <hr />


<?php if ($hasDependencies): ?>
    <p id="dependencies">
        Below is a dependency graph between Yii 3 packages generated by scanning the <code>require</code> section
        of each package <em>composer.json</em> file.
    </p>

    <div id="graph"></div>
    <small><a href="http://bl.ocks.org/jkschneider/c7660044fe74ab9ee53e">credits</a></small>

<?php else: ?>
    <p id="dependencies">
        A dependency graph can be generated using d3 js and displayed in this page.
    </p>
    <pre><code>
# clone all yii3 repositories (as defined in `config/params.php`)
./yii github/clone

# generate the dependencies json file
/yii packages/d3
</code></pre>
<?php endif ?>